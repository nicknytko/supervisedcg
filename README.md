~~gross~~ research codes, proceed at own risk
